var handlerAttributeName="data-no-handler",debugMode=!1;function httpGetAsync(e,t,n){"use strict";var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status?t(a.responseText):4===a.readyState&&200!==a.status&&n(a.responseText,a.status)},a.open("GET",e,!0),a.send(null)}function afterDomLoads(t){"use strict";if(window.attachEvent)window.attachEvent("onload",t);else if(window.onload){var n=window.onload;window.onload=function(e){n(e),t(e)}}else window.onload=t}function renderTemplate(e,t){for(var n,a=/<%([^%>]+)?%>/g,o=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,r="var r=[];\n",d=0,i=function(e,t){return r+=t?e.match(o)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",i};n=a.exec(e);)i(e.slice(d,n.index))(n[1],!0),d=n.index+n[0].length;return i(e.substr(d,e.length-d)),r+='return r.join("");',new Function(r.replace(/[\r\t\n]/g,"")).apply(t)}function renderEndpoint(e,a,o,t,r){var d;d=a.className,a.className=d+" no-loading",httpGetAsync(e,function(n){a.className=d,isDebugEnabled()&&console.info("Retrieved data ",n," from ",e),"function"==typeof t&&(n=t(n),isDebugEnabled()&&console.info("Transformed data into ",n)),httpGetAsync(o,function(e){var t=renderTemplate(e,n);a.innerHTML=t,"function"==typeof r&&r(a)},function(e,t){console.error("Couldn't retrieve template from path: ",o,", status ",t),"function"==typeof r&&r(a)})},function(e,t){console.error("Retrieved: ",e," with status ",t),a.className=d+" no-error","function"==typeof r&&r(a)})}function isDebugEnabled(){return debugMode}window.dataHandlers={noJsonHandler:function(e){return JSON.parse(e)}},window.handlers={noHandler:function(e){var t=e.getAttribute("data-no-data-handler"),n=window.dataHandlers.noJsonHandler;isDebugEnabled()&&console.info("Datahandler: ",t),"function"==typeof window.dataHandlers[t]?n=window.dataHandlers[t]:isDebugEnabled()&&(null!==t?console.error("Datahandler ",t," is not a registered handler. Please register to window.dataHandlers"):console.info("Using default noJsonHandler")),renderEndpoint(e.getAttribute("data-no-url"),e,e.getAttribute("data-no-template"),n,function(e){e.removeAttribute("data-no-url"),e.removeAttribute("data-no-template"),e.removeAttribute("data-no-data-handler")})}},afterDomLoads(function(){"use strict";var e;void 0!==(e=document.getElementsByTagName("body")[0])&&e.hasAttribute("data-no-debug")&&("true"===e.getAttribute("data-no-debug")&&(console.info("Debug mode is enabled."),debugMode=!0),e.removeAttribute("data-no-debug")),function(){var e,t,n=document.querySelectorAll("["+handlerAttributeName+"]");for(e=0;e<n.length;e+=1)t=n[e].getAttribute(handlerAttributeName),"function"==typeof window.handlers[t]?(isDebugEnabled()&&console.info("Executing `",t,"` for element ",n[e]),window.handlers[t](n[e]),n[e].removeAttribute(handlerAttributeName)):console.error("Element ",n[e]," has invalid handler `",t,"`")}()});