var handlerAttributeName="data-no-handler",debugMode=!1;function httpGetAsync(e,n,t){"use strict";var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&200===o.status?n(o.responseText):4===o.readyState&&200!==o.status&&t(o.responseText,o.status)},o.open("GET",e,!0),o.send(null)}function afterDomLoads(n){"use strict";if(window.attachEvent)window.attachEvent("onload",n);else if(window.onload){var t=window.onload;window.onload=function(e){t(e),n(e)}}else window.onload=n}function renderTemplate(e,n){for(var t,o=/<%([^%>]+)?%>/g,a=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,r="var r=[];\n",d=0,i=function(e,n){return r+=n?e.match(a)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",i};t=o.exec(e);)i(e.slice(d,t.index))(t[1],!0),d=t.index+t[0].length;return i(e.substr(d,e.length-d)),r+='return r.join("");',new Function(r.replace(/[\r\t\n]/g,"")).apply(n)}function renderJsonEndpoint(e,o,a,n,r){var d;d=o.className,o.className=d+" no-loading",httpGetAsync(e,function(t){o.className=d,isDebugEnabled()&&console.info("Retrieved data ",t," from ",e),"function"==typeof n&&(t=n(t),isDebugEnabled()&&console.info("Transformed data into ",t)),httpGetAsync(a,function(e){var n=renderTemplate(e,t);o.innerHTML=n,"function"==typeof r&&r(o)},function(e,n){console.error("Couldn't retrieve template from path: ",a,", status ",n),"function"==typeof r&&r(o)})},function(e,n){console.error("Retrieved: ",e," with status ",n),o.className=d+" no-error","function"==typeof r&&r(o)})}function isDebugEnabled(){return debugMode}window.dataHandlers={noJsonHandler:function(e){return JSON.parse(e)}},window.handlers={noHandler:function(e){var n=e.getAttribute("data-no-data-handler"),t=window.dataHandlers.noJsonHandler;isDebugEnabled()&&console.info("Datahandler: ",n),"function"==typeof window.dataHandlers[n]?t=window.dataHandlers[n]:isDebugEnabled()&&(null!==n?console.error("Datahandler ",n," is not a registered handler. Please register to window.dataHandlers"):console.info("Using default noJsonHandler")),renderJsonEndpoint(e.getAttribute("data-no-url"),e,e.getAttribute("data-no-template"),t,function(e){e.removeAttribute("data-no-url"),e.removeAttribute("data-no-template"),e.removeAttribute("data-no-data-handler")})}},afterDomLoads(function(){"use strict";var e;void 0!==(e=document.getElementsByTagName("body")[0])&&e.hasAttribute("data-no-debug")&&("true"===e.getAttribute("data-no-debug")&&(console.info("Debug mode is enabled."),debugMode=!0),e.removeAttribute("data-no-debug")),function(){var e,n,t=document.querySelectorAll("["+handlerAttributeName+"]");for(e=0;e<t.length;e+=1)n=t[e].getAttribute(handlerAttributeName),"function"==typeof window.handlers[n]?(isDebugEnabled()&&console.info("Executing `",n,"` for element ",t[e]),window.handlers[n](t[e]),t[e].removeAttribute(handlerAttributeName)):console.error("Element ",t[e]," has invalid handler `",n,"`")}()});